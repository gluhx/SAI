{% extends "base.html" %}
{% block title %}Список технологических процессов{% endblock %}
{% block page_title %}Технологические процессы{% endblock %}
{% block extra_css %}
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='styles/technologist/processes.css') }}">
{% endblock %}
{% block content %}
<main class="processes-content">
    <h1 class="page-title">Список технологических процессов</h1>
    {% if processes_data %}
        <div class="processes-table">
            <div class="processes-header">
                <div class="col-id">Номер ТП</div>
                <div class="col-note">Описание</div>
                {% if role in ['technologist', 'director'] %}
                    <div class="col-actions">Действия</div>
                {% endif %}
            </div>
            {% for process in processes_data %}
                <div class="process-row" onclick="window.location.href='/process/{{ process['id'] }}'">
                    <div class="col-id">ТП-{{ process['id'] }}</div>
                    <div class="col-note">
                        {{ process['note'][:55] + ('...' if process['note']|length > 55 else '') }}
                    </div>
                    {% if role in ['technologist', 'director'] %}
                        <div class="col-actions">
                            <a href="/process/delete/{{ process['id'] }}" class="delete-btn" 
                               onclick="event.stopPropagation(); return confirm('Удалить ТП?')">
                                Удалить
                            </a>
                        </div>
                    {% endif %}
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p class="empty-message">Нет технологических процессов.</p>
    {% endif %}
    {% if role in ['technologist', 'director'] %}
        <div class="add-process-card">
            <h2>Создать новый технологический процесс</h2>
            <form method="post" action="/add-process" class="add-process-form">
                <div class="form-group">
                    <label for="process_note">Описание процесса</label>
                    <textarea id="process_note" name="process_note" rows="3" 
                              placeholder="Краткое описание назначения и содержания ТП" required></textarea>
                </div>
                <button type="submit" class="btn-primary">Добавить ТП</button>
            </form></br>
            <a href="/expert/generate-tp" class="btn-primary">Сгенерировать ТП</a>
        </div>
    {% endif %}
</main>
<footer class="footer">Хорошего дня!</footer>
{% endblock %}
